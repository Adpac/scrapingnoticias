

{{texto|safe}}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/sweetalert2/6.5.6/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/sweetalert2/6.5.6/sweetalert2.min.js"></script>
<script src="/static/scripts/selectorxpathnoticias.js" ></script>
{% if editar!=ninguno %}
<div hidden id="datosri"  xptitular="{{reglainterna['xptitular']}}"
xpresumen="{{reglainterna['xpresumen']}}"
xpimg="{{reglainterna['xpimg']}}"
xpdesimg="{{reglainterna['xpdesimg']}}"
xpredactor="{{reglainterna['xpresumen']}}"
xpfecha="{{reglainterna['xpfecha']}}"
xpparrafos="{{reglainterna['xpparrafos']}}"
xphashtags="{{reglainterna['xprhashtags']}}"
>
</div>


{% endif %}

<div class="xpathmenu" marcar="nopintar" id="xpathmenu">
    <div class="selector" marcar="nopintar"></div> 
    <form name="enviarurl" id="formlista" method="post" action="{{url_for('subirpagina')}}">
        <input type="hidden" name="tiporeglaexterna" value="{{tipo}}">
        <input type="hidden" name="datosreglaexterna" value="{{jsonp1}}">
        <input type="hidden" name="urlexterna" value="{{urlext}}">
        <input type="hidden" name="categoria" value="{{categoria}}">
        <input type="hidden" name="reglaex" id="reglaex" value="ninguno">
        <table marcar="nopintar" id="tablaxp" width="100%">
            <tbody marcar="nopintar">
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input1">Titular de la noticia</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(1)" id="pintartag1" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" autocomplete="off" placeholder="Xpath titular"  marcar="nopintar" id="input1" onkeyup="pintarelemento(1)" name="input1"></td>
                    <td marcar="nopintar"><div id="datos1"marcar="nopintar" class="datosxpath"></div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input2">Resumen de la Noticia</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(2)" id="pintartag2" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" autocomplete="off" placeholder="Xpath resumen"  marcar="nopintar" id="input2" onkeyup="pintarelemento(2)" name="input2"></td>
                    <td marcar="nopintar"><div id="datos2" class="datosxpath" marcar="nopintar"></div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar"for="input3">Imagen de la noticia</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(3)" id="pintartag3" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text"autocomplete="off" marcar="nopintar" placeholder="Xpath imagen"  id="input3" onkeyup="pintarelemento(3)" name="input3"></td>
                    <td marcar="nopintar"><div id="datos3" class="datosxpath" marcar="nopintar"> </div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input4">Descripción de la imagen</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(4)" id="pintartag4" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" autocomplete="off" placeholder="Xpath descripcion de la imagen"  marcar="nopintar" id="input4" onkeyup="pintarelemento(4)" name="input4"></td>
                    <td marcar="nopintar"><div id="datos4" class="datosxpath" marcar="nopintar"></div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input5">Redactor de la noticia</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(5)" id="pintartag5" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" autocomplete="off" placeholder="Xpath redactor"  marcar="nopintar" id="input5" onkeyup="pintarelemento(5)" name="input5"></td>
                    <td marcar="nopintar"><div id="datos5" class="datosxpath" marcar="nopintar"></div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input6">Fecha y hora de la noticia</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(6)" id="pintartag6" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" autocomplete="off" placeholder="Xpath fecha"  marcar="nopintar" id="input6" onkeyup="pintarelemento(6)" name="input6"></td>
                    <td marcar="nopintar"><div id="datos6" class="datosxpath" marcar="nopintar"></div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input7">Parrafos de la noticia</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(7)" id="pintartag7" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" autocomplete="off" placeholder="Xpath parrafos"  marcar="nopintar" id="input7" onkeyup="pintarelemento(7)" name="input7"></td>
                    <td marcar="nopintar"><div id="datos7" class="datosxpath" marcar="nopintar"></div></div></td>
                </tr>
                <tr marcar="nopintar">
                    <td marcar="nopintar"><label marcar="nopintar" for="input8">Hashtags</label></td>
                    <td marcar="nopintar"><button class="btnsel" type="button" onclick="seleccionarcampo(8)" id="pintartag8" marcar="nopintar">Seleccionar</button></td>
                    <td marcar="nopintar"> <input type="text" placeholder="Xpath Hashtags"  marcar="nopintar" id="input8" onkeyup="pintarelemento(8)" name="input8"></td>
                    <td marcar="nopintar"><div id="datos8" autocomplete="off" class="datosxpath" marcar="nopintar"></div></div></td>
                </tr>
            </tbody>

        </table>
        <button id="inputaceptar" marcar="nopintar" type="button" name="enviar" id="btnsubmit" onclick="validarform()">Aceptar</button>
        <button  marcar="nopintar" id="btncambiarposicion" type="button" onclick="cambiarposicion()">Pasar Abajo</button>

    </form>

    
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="/static/scripts/selectorxpathnoticias.js" ></script>
<script>
    
    var editar="{{editar}}"
    if(editar!="ninguno"){
        console.log("Regla interna.....................")
        console.log(editar)
        var reglainterna=$('#datosri')
        jQuery("#input1").val(reglainterna.attr("xptitular"))
        jQuery("#input2").val(reglainterna.attr("xpresumen"))
        jQuery("#input3").val(reglainterna.attr("xpimg"))
        jQuery("#input4").val(reglainterna.attr("xpdesimg"))
        jQuery("#input5").val(reglainterna.attr("xpredactor"))
        jQuery("#input6").val(reglainterna.attr("xpfecha"))
        jQuery("#input7").val(reglainterna.attr("xpparrafos"))
        jQuery("#input8").val(reglainterna.attr("xphashtags"))
        pintarelemento(1);
        pintarelemento(2);
        pintarelemento(3);
        pintarelemento(4);
        pintarelemento(5);
        pintarelemento(6);
        pintarelemento(7);
        pintarelemento(8);
    }
</script>
<script>
    //Script para la seleccion de reglas
    $('#selregla').change(function(){ 
    var value = $(this).val();
    var seleccion=$(this).find('option:selected');
    $("#input1").val(seleccion.attr("xptitu"))
    $("#input2").val(seleccion.attr("xpres"))
    $("#input3").val(seleccion.attr("xpimg"))
    $("#input4").val(seleccion.attr("xpdesimg"))
    $("#input5").val(seleccion.attr("xpred"))
    $("#input6").val(seleccion.attr("xpfecha"))
    $("#input7").val(seleccion.attr("xparr"))
    $("#input8").val(seleccion.attr("xphas"))

    pintarelemento(1);
    pintarelemento(2);
    pintarelemento(3);
    pintarelemento(4);
    pintarelemento(5);
    pintarelemento(6);
    pintarelemento(7);
    pintarelemento(8);


});
function cambioregla(){
    //Retornara verdadero en caso de que se detecten cambios entre la regla seleccionada y los valoresdentro de esta
    retornar=false;

        var seleccion=$('#datosri')
        if(seleccion.attr("xptitular")!=$("#input1").val() || seleccion.attr("xpresumen")!=$("#input2").val() ||seleccion.attr("xpimg")!=$("#input3").val() || seleccion.attr("xpdesimg")!=$("#input4").val() || seleccion.attr("xpredactor")!=$("#input5").val()|| seleccion.attr("xpfecha")!=$("#input6").val()|| seleccion.attr("xpparrafos")!=$("#input7").val()|| seleccion.attr("xphashtags")!=$("#input8").val()){
            retornar=true;
        }
    
    return retornar
}
function validarform(){
    var form = jQuery("#formlista")
    var cambios="{{cambios}}"
    console.log(cambios)
    if( (cambioregla()  || cambios=="true") && "{{editar}}"!="ninguno" ){
        swal({
            title: "¿Desea modificar la regla actual?",
            text: "Recuerde que esta regla es utilizada por diferentes enlaces, si selecciona \"Crear nueva regla\" solo se aplicaran los cambios a esta URL ",

            showCancelButton: true,
            showCloseButton: true,
            confirmButtonText: 'Editar Parametros',
            cancelButtonText: `Crear nueva regla`,
          })
          .then(function() {
            jQuery("#reglaex").val(editar)
                swal("Se modificara la regla"+editar);
                form.submit();
          },function(dismiss){
            if(dismiss == 'cancel') {
                swal("Se creara una nueva regla");
              form.submit();
            }}
            
          );
    }else{
        form.submit();
    }
    
}
</script>