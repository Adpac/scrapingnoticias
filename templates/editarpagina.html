{% if session['type']=="usuario" %}
    {%extends "layoutusuario.html"%}
{% elif session['type']=="adminsitrador" %}
    {%extends "layoutadmin.html"%}
{% elif session['type']=="admingen" %}
    {%extends "layoutadmingen.html"%}
{% else %}
{%extends "layout.html" %}
{% endif %}



{% block titulo1 %}
Editar Pagina: {{paginanoticia['url']}}
{% endblock %}
{% block content %}
<div style="height: 50px;">

</div>
<link rel="stylesheet" href="https://unpkg.com/@jarstone/dselect/dist/css/dselect.css">
<script src="https://unpkg.com/@jarstone/dselect/dist/js/dselect.js"></script>
<link href="https://cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/css/alertify.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/alertifyjs@1.11.0/build/alertify.min.js"></script>
<h4>Reglas de Portada</h4>
<table class="table table-bordered">
    <thead class="thead-dark">
      <tr >
        <th scope="col">#</th>
        <th scope="col">Url Portada</th>
        <th scope="col">Editar</th>
        <th scope="col">Eliminar</th>
      </tr>
    </thead>
    <tbody>
        {% for portada in paginanoticia['portada'] %}
        <tr class="table-light">
            <th scope="row">{{loop.index0 +1}}</th>
            <td>{{portada['urlportada']}}</td>
            <td><a class="btn btn-primary">Editar Regla</a></td>
            <td><a class="btn btn-primary">Eliminar</a></td>
        </tr>
        {% endfor %}
    </tbody>
  </table>
<h4>Reglas de Categoria</h4>
  <table class="table table-bordered">
      <thead class="thead-dark">
        <tr >
          <th scope="col">#</th>
          <th scope="col">Url Categoria</th>
          <th scope="col">Categoria</th>
          <th scope="col">Editar Reglas</th>
          <th scope="col">Eliminar</th>
        </tr>
      </thead>
      <tbody>
        <input type="hidden" id="cont" name="numurls" value="{{paginanoticia['categorias']|length}}">
          {% for urlcategoria in paginanoticia['categorias'] %}
          <tr class="table-light">
              <th scope="row">{{loop.index0 +1}}</th>
              <td>{{urlcategoria['url']}}</td>
              <td>
                <select id="cat{{loop.index0 +1}}" name="categoria" name="select_box" class="form-select">
                    <option value="">Selecciona una categoria</option>
                    {% for categoria in listacategorias %}
                        {% set idcat = categoria['_id']| string() %}
                        {%if idcat==urlcategoria['idcategoria'] %}
                        <option value="{{categoria['_id']}}" data-tokens="{{categoria['cat']}}" selected>{{categoria['cat']}}</option>
                        {%else%}
                        <option value="{{categoria['_id']}}" data-tokens="{{categoria['cat']}}">{{categoria['cat']}}</option>
                        {%endif%}
                    {% endfor%}
                </select>
              </td>
              <td><a class="btn btn-primary" href="{{url_for('editreglascategoria')}}?urlcategoria={{urlcategoria['url']}}&categoria={{urlcategoria['idcategoria']}}">Editar Regla</a></td>
              <td><button class="btn btn-primary" onclick="eliminarcategoria('{{urlcategoria['url']}}')">Eliminar</button></td>
          </tr>
          {% endfor %}
      </tbody>
    </table>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        console.log("llegue aqui1.........")
        var select_box_element = document.querySelector('#cat1');
        dselect(select_box_element, {
                        search: true
            });
        console.log("llegue aqui.........")

    function eliminarcategoria(urlcategoria){
      swal({
            title: "¿Esta seguro de eliminar esta SubURL?",
            text: "Las noticias pertenecientes a esté dominio no se eliminarán",
            buttons: true,
            dangerMode: true,
          })
          .then((willDelete) => {
            if (willDelete) {
              swal("Sub URL eliminada", {
                icon: "success",
              });
            } else {
              swal("No se elimino la SubURL");
            }
          });
    }
    </script>
    
{% endblock %}
